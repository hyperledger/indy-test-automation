name: "Run Tests"

on:
  workflow_call:
    inputs:
      GITHUB_REPOSITORY_NAME:
        required: true
        type: string
      ubuntuVersion:
        type: string
        description: 'Version of Ubuntu base image'
        required: true
        default: 'ubuntu-1604'
      
env:
  TEST_AUTOMATION_BRANCH: "main"
  GITHUB_REPOSITORY_NAME: ${{ inputs.GITHUB_REPOSITORY_NAME }} 


jobs:
  ### 1 step in workflow  per test
  ### The tests rely on docker in docker with the fixed network name and fixed IP addresses. 
  ### That's why the tests cannot be run in matrix mode because all tests would share the same host and same docker engine.
  test_consensus:
    name: test_consensus
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_consensus
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_consensus.py "-l -v --junit-xml=test_consensus-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_consensus Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_consensus.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_consensus
          path: test-result-indy-test-automation-test_consensus.txt
          retention-days: 5

  test_freshness:
    name: test_freshness
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"
      
      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_freshness
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_freshness.py "-l -v --junit-xml=test_freshness-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_freshness Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_freshness.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_freshness
          path: test-result-indy-test-automation-test_freshness.txt
          retention-days: 5

  test_ledger:
    name: test_ledger
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_ledger
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_ledger.py "-l -v --junit-xml=test_ledger-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_ledger Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_ledger.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_ledger
          path: test-result-indy-test-automation-test_ledger.txt
          retention-days: 5
      
  test_off_ledger_signature:
    name: test_off_ledger_signature
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_off_ledger_signature
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_off_ledger_signature.py "-l -v --junit-xml=test_off_ledger_signature-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_off_ledger_signature Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_off_ledger_signature.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_off_ledger_signature
          path: test-result-indy-test-automation-test_off_ledger_signature.txt
          retention-days: 5 

  test_roles:
    name: Test Roles
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_roles
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_roles.py "-l -v --junit-xml=test_roles-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_roles Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_roles.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_roles
          path: test-result-indy-test-automation-test_roles.txt
          retention-days: 5

  test_state_proof:
    name: test_state_proof
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_state_proof
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_state_proof.py "-l -v --junit-xml=test_state_proof-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_state_proof Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_state_proof.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_state_proof
          path: test-result-indy-test-automation-test_state_proof.txt
          retention-days: 5

  test_vc:
    name: test_vc
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: test_vc
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/test_vc.py "-l -v --junit-xml=test_vc-report.xml" indy-test-automation-network
  
      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: test_vc Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.test_vc.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-test_vc
          path: test-result-indy-test-automation-test_vc.txt
          retention-days: 5

  TestAdHocSuite:
    name: TestAdHocSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAdHocSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAdHocSuite.py "-l -v --junit-xml=TestAdHocSuite-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAdHocSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAdHocSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAdHocSuite
          path: test-result-indy-test-automation-TestAdHocSuite.txt
          retention-days: 5

  TestAuditSuite:
    name: TestAuditSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuditSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuditSuite.py "-l -v --junit-xml=TestAuditSuite-report.xml" indy-test-automation-network 
      
      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuditSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuditSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuditSuite
          path: test-result-indy-test-automation-TestAuditSuite.txt
          retention-days: 5

  TestAuthMapAttribSuite:
    name: TestAuthMapAttribSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapAttribSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapAttribSuite.py "-l -v --junit-xml=TestAuthMapAttribSuite-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapAttribSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapAttribSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapAttribSuite
          path: test-result-indy-test-automation-TestAuthMapAttribSuite.txt
          retention-days: 5

  TestAuthMapCredDefSuite:
    name: TestAuthMapCredDefSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapCredDefSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapCredDefSuite.py "-l -v --junit-xml=TestAuthMapCredDefSuite-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapCredDefSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapCredDefSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapCredDefSuite
          path: test-result-indy-test-automation-TestAuthMapCredDefSuite.txt
          retention-days: 5

  TestAuthMapMiscSuite:
    name: TestAuthMapMiscSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapMiscSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapMiscSuite.py "-l -v --junit-xml=TestAuthMapMiscSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapMiscSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapMiscSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapMiscSuite
          path: test-result-indy-test-automation-TestAuthMapMiscSuite.txt
          retention-days: 5

  TestAuthMapNymSuite:
    name: TestAuthMapNymSuite
    runs-on: ubuntu-latest 
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapNymSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapNymSuite.py "-l -v --junit-xml=TestAuthMapNymSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapNymSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapNymSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapNymSuite
          path: test-result-indy-test-automation-TestAuthMapNymSuite.txt
          retention-days: 5

  TestAuthMapRevocRegDefSuite:
    name: TestAuthMapRevocRegDefSuite
    runs-on: ubuntu-latest 
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapRevocRegDefSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapRevocRegDefSuite.py "-l -v --junit-xml=TestAuthMapRevocRegDefSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapRevocRegDefSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapRevocRegDefSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapRevocRegDefSuite
          path: test-result-indy-test-automation-TestAuthMapRevocRegDefSuite.txt
          retention-days: 5

  TestAuthMapRevocRegEntrySuite:
    name: TestAuthMapRevocRegEntrySuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapRevocRegEntrySuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapRevocRegEntrySuite.py "-l -v --junit-xml=TestAuthMapRevocRegEntrySuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapRevocRegEntrySuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapRevocRegEntrySuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapRevocRegEntrySuite
          path: test-result-indy-test-automation-TestAuthMapRevocRegEntrySuite.txt
          retention-days: 5

  TestAuthMapSchemaSuite:
    name: TestAuthMapSchemaSuite
    runs-on: ubuntu-latest 
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapSchemaSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapSchemaSuite.py "-l -v --junit-xml=TestAuthMapSchemaSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapSchemaSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapSchemaSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapSchemaSuite
          path: test-result-indy-test-automation-TestAuthMapSchemaSuite.txt
          retention-days: 5

  TestAuthMapUpgradeSuite:
    name: TestAuthMapUpgradeSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestAuthMapUpgradeSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestAuthMapUpgradeSuite.py "-l -v --junit-xml=TestAuthMapUpgradeSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestAuthMapUpgradeSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestAuthMapUpgradeSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestAuthMapUpgradeSuite
          path: test-result-indy-test-automation-TestAuthMapUpgradeSuite.txt
          retention-days: 5

  TestCatchUpSuite:
    name: TestCatchUpSuite
    runs-on: ubuntu-latest 
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestCatchUpSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestCatchUpSuite.py "-l -v --junit-xml=TestCatchUpSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestCatchUpSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestCatchUpSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestCatchUpSuite
          path: test-result-indy-test-automation-TestCatchUpSuite.txt
          retention-days: 5

  TestCatchUpSuiteExtended:
    name: TestCatchUpSuiteExtended
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"
      
      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestCatchUpSuiteExtended
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestCatchUpSuiteExtended.py "-l -v --junit-xml=TestCatchUpSuiteExtended-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestCatchUpSuiteExtended Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestCatchUpSuiteExtended.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestCatchUpSuiteExtended
          path: test-result-indy-test-automation-TestCatchUpSuiteExtended.txt
          retention-days: 5

  TestConsensusSuite:
    name: TestConsensusSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestConsensusSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestConsensusSuite.py "-l -v --junit-xml=TestConsensusSuite-report.xml" indy-test-automation-network 
      
      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestConsensusSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestConsensusSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestConsensusSuite
          path: test-result-indy-test-automation-TestConsensusSuite.txt
          retention-days: 5

  TestMultiSigSuite:
    name: TestMultiSigSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestMultiSigSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestMultiSigSuite.py "-l -v --junit-xml=TestMultiSigSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestMultiSigSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestMultiSigSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestMultiSigSuite
          path: test-result-indy-test-automation-TestMultiSigSuite.txt
          retention-days: 5

  TestProductionSuite:
    name: TestProductionSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestProductionSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestProductionSuite.py "-l -v --junit-xml=TestProductionSuite-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestProductionSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestProductionSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestProductionSuite
          path: test-result-indy-test-automation-TestProductionSuite.txt
          retention-days: 5

  TestTAASuite:
    name: TestTAASuite
    runs-on: ubuntu-latest 
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestTAASuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestTAASuite.py "-l -v --junit-xml=TestTAASuite-report.xml" indy-test-automation-network 

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestTAASuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestTAASuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestTAASuite
          path: test-result-indy-test-automation-TestTAASuite.txt
          retention-days: 5

  TestViewChangeSuite:
    name: TestViewChangeSuite
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout hyperledger/indy-test-automation
        uses: actions/checkout@v3
        with:
          repository: hyperledger/indy-test-automation
          ref: ${{ env.TEST_AUTOMATION_BRANCH }}

      - name: Create docker network
        run: |
          docker network create --subnet="10.0.0.0/24" "indy-test-automation-network"

      - name: Download client artifact
        uses: actions/download-artifact@v3
        with:
          name: client_image
          path: /tmp

      - name: Download node artifact
        uses: actions/download-artifact@v3
        with:
          name: node_image
          path: /tmp

      - name: Load client and node image
        run: |
          docker load --input /tmp/client_image_${{ inputs.ubuntuVersion }}.tar
          docker load --input /tmp/node_image_${{ inputs.ubuntuVersion }}.tar

      - name: test
        id: TestViewChangeSuite
        run: |
          cd ./system_node_only/docker
          sudo UBUNTU_VERSION="${{ inputs.ubuntuVersion }}" IMAGE_REPOSITORY="ghcr.io/${{ env.GITHUB_REPOSITORY_NAME }}/" CLIENT_IMAGE="client:${{ inputs.ubuntuVersion }}" NODE_IMAGE="node-${{ inputs.ubuntuVersion }}" ./run.sh system_node_only/indy-node-tests/TestViewChangeSuite.py "-l -v --junit-xml=TestViewChangeSuite-report.xml" indy-test-automation-network

      - name: Publish Test Report
        if: success() || failure()
        uses: scacap/action-surefire-report@v1.0.7
        continue-on-error: true
        with:
          check_name: TestViewChangeSuite Test Report
          github_token: ${{ secrets.GITHUB_TOKEN }}
          report_paths: "*-report.xml"

      - name: Upload Detailed Test Failure Results
        # The test runner only emits the detailed test results if the tests fail.
        if: (steps.TestViewChangeSuite.outcome == 'failure') && failure()
        uses: actions/upload-artifact@v3
        with:
          name: detailed-test-result-TestViewChangeSuite
          path: test-result-indy-test-automation-TestViewChangeSuite.txt
          retention-days: 5
